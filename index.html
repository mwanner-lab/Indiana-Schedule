<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fluidstack 245MW - Construction Schedule</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e4e4e7;
            padding: 20px;
        }

        .container { max-width: 1600px; margin: 0 auto; }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(90deg, #60a5fa, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }

        .subtitle { color: #94a3b8; font-size: 0.95rem; }

        .project-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .info-card {
            background: rgba(59, 130, 246, 0.1);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .info-card label {
            font-size: 0.75rem;
            color: #94a3b8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-card .value {
            font-size: 1.25rem;
            font-weight: 600;
            color: #60a5fa;
            margin-top: 4px;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.05);
            color: #e4e4e7;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.85rem;
        }

        .filter-btn:hover, .filter-btn.active {
            background: rgba(59, 130, 246, 0.3);
            border-color: #60a5fa;
        }

        .legend {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            padding: 15px;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
        }

        /* RAG Legend */
        .rag-legend {
            display: flex;
            gap: 20px;
            padding: 10px 15px;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            margin-bottom: 20px;
            align-items: center;
        }

        .rag-legend-title {
            font-size: 0.8rem;
            color: #94a3b8;
            font-weight: 500;
        }

        .rag-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
        }

        .rag-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .rag-dot.red { background: #ef4444; }
        .rag-dot.amber { background: #f59e0b; }
        .rag-dot.green { background: #22c55e; }
        .rag-dot.none { background: #64748b; }

        .gantt-container {
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            overflow: hidden;
        }

        .gantt-header {
            display: grid;
            grid-template-columns: 50px 320px 1fr;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .rag-header, .task-header {
            padding: 12px 16px;
            font-weight: 600;
            font-size: 0.85rem;
            color: #94a3b8;
            border-right: 1px solid rgba(255,255,255,0.1);
        }

        .rag-header {
            text-align: center;
            padding: 12px 8px;
        }

        .timeline-header {
            display: flex;
            overflow-x: auto;
        }

        .month-label {
            min-width: 60px;
            padding: 12px 8px;
            text-align: center;
            font-size: 0.75rem;
            color: #94a3b8;
            border-right: 1px solid rgba(255,255,255,0.05);
        }

        .month-label.year-start {
            border-left: 2px solid rgba(255,255,255,0.2);
        }

        .gantt-body {
            max-height: 70vh;
            overflow-y: auto;
            overflow-x: hidden;
        }

        .gantt-row {
            display: grid;
            grid-template-columns: 50px 320px 1fr;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            transition: background 0.2s;
        }

        .gantt-row:hover {
            background: rgba(255,255,255,0.03);
        }

        .gantt-row.phase-header {
            background: rgba(59, 130, 246, 0.1);
        }

        .gantt-row.phase-header .task-name {
            font-weight: 700;
            color: #60a5fa;
        }

        .rag-cell {
            display: flex;
            align-items: center;
            justify-content: center;
            border-right: 1px solid rgba(255,255,255,0.1);
            cursor: pointer;
        }

        .rag-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.2);
            transition: all 0.2s;
        }

        .rag-indicator:hover {
            transform: scale(1.2);
        }

        .rag-indicator.red { background: #ef4444; border-color: #ef4444; }
        .rag-indicator.amber { background: #f59e0b; border-color: #f59e0b; }
        .rag-indicator.green { background: #22c55e; border-color: #22c55e; }
        .rag-indicator.none { background: transparent; }

        .task-cell {
            padding: 10px 16px;
            border-right: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .task-cell:hover {
            background: rgba(255,255,255,0.02);
        }

        .task-name {
            font-size: 0.85rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
        }

        .task-indent-1 { padding-left: 32px; }
        .task-indent-2 { padding-left: 48px; }
        .task-indent-3 { padding-left: 64px; }

        .task-duration {
            font-size: 0.7rem;
            color: #64748b;
            white-space: nowrap;
        }

        .has-comment {
            color: #60a5fa;
            font-size: 12px;
        }

        .timeline-cell {
            position: relative;
            height: 40px;
            display: flex;
            align-items: center;
        }

        .bar {
            position: absolute;
            height: 24px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            padding: 0 8px;
            font-size: 0.7rem;
            font-weight: 500;
            color: white;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            overflow: hidden;
            white-space: nowrap;
        }

        .bar:hover {
            transform: scaleY(1.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 5;
        }

        .bar.design { background: linear-gradient(90deg, #8b5cf6, #a78bfa); }
        .bar.procurement { background: linear-gradient(90deg, #6366f1, #818cf8); }
        .bar.sitework { background: linear-gradient(90deg, #14b8a6, #2dd4bf); }
        .bar.building { background: linear-gradient(90deg, #3b82f6, #60a5fa); }
        .bar.mechanical { background: linear-gradient(90deg, #0ea5e9, #38bdf8); }
        .bar.electrical { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .bar.commissioning { background: linear-gradient(90deg, #ec4899, #f472b6); }
        .bar.datahall { background: linear-gradient(90deg, #10b981, #34d399); }
        .bar.closeout { background: linear-gradient(90deg, #64748b, #94a3b8); }
        .bar.milestone { background: linear-gradient(90deg, #22c55e, #4ade80); }

        .milestone-marker {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-bottom: 16px solid #fbbf24;
            transform: translateX(-10px);
            cursor: pointer;
        }

        .grid-lines {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            pointer-events: none;
        }

        .grid-line {
            min-width: 60px;
            border-right: 1px solid rgba(255,255,255,0.03);
        }

        .grid-line.year-start {
            border-right: 2px solid rgba(255,255,255,0.1);
        }

        /* Today Line */
        .today-line {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #ef4444;
            z-index: 4;
            pointer-events: none;
        }
        .today-line::after {
            content: 'TODAY';
            position: absolute;
            top: -18px;
            left: -16px;
            font-size: 0.6rem;
            color: #ef4444;
            font-weight: 700;
        }

        /* Tooltip */
        .tooltip {
            position: fixed;
            background: #1e293b;
            border: 1px solid rgba(255,255,255,0.2);
            padding: 12px;
            border-radius: 8px;
            font-size: 0.8rem;
            z-index: 100;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            max-width: 300px;
        }

        .tooltip.visible { opacity: 1; }
        .tooltip-title { font-weight: 600; margin-bottom: 8px; color: #60a5fa; }
        .tooltip-row { display: flex; justify-content: space-between; margin-bottom: 4px; }
        .tooltip-label { color: #94a3b8; }

        .complete { color: #4ade80; }
        .high { color: #60a5fa; }
        .medium { color: #fbbf24; }
        .low { color: #f87171; }
        .not-started { color: #94a3b8; }

        .progress-fill-complete { background: linear-gradient(90deg, #22c55e, #4ade80); }
        .progress-fill-high { background: linear-gradient(90deg, #3b82f6, #60a5fa); }
        .progress-fill-medium { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .progress-fill-low { background: linear-gradient(90deg, #ef4444, #f87171); }
        .progress-fill-not-started { background: rgba(255,255,255,0.2); }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active { display: flex; }

        .modal {
            background: #1e293b;
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 30px;
            min-width: 450px;
            max-width: 90%;
        }

        .modal h3 {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #f1f5f9;
        }

        .modal .input-group {
            margin-bottom: 15px;
        }

        .modal .input-group label {
            display: block;
            font-size: 0.8rem;
            color: #94a3b8;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .modal input, .modal textarea, .modal select {
            width: 100%;
            padding: 12px 16px;
            background: rgba(0,0,0,0.3);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: #f1f5f9;
            font-size: 1rem;
            font-family: inherit;
        }

        .modal textarea {
            min-height: 100px;
            resize: vertical;
        }

        .modal input:focus, .modal textarea:focus, .modal select:focus {
            outline: none;
            border-color: #60a5fa;
        }

        .rag-select-group {
            display: flex;
            gap: 10px;
        }

        .rag-option {
            flex: 1;
            padding: 12px;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .rag-option:hover { border-color: rgba(255,255,255,0.3); }
        .rag-option.selected { border-width: 3px; }
        .rag-option.red { border-color: #ef4444; background: rgba(239, 68, 68, 0.1); }
        .rag-option.red.selected { background: rgba(239, 68, 68, 0.2); }
        .rag-option.amber { border-color: #f59e0b; background: rgba(245, 158, 11, 0.1); }
        .rag-option.amber.selected { background: rgba(245, 158, 11, 0.2); }
        .rag-option.green { border-color: #22c55e; background: rgba(34, 197, 94, 0.1); }
        .rag-option.green.selected { background: rgba(34, 197, 94, 0.2); }
        .rag-option.none { border-color: #64748b; background: rgba(100, 116, 139, 0.1); }
        .rag-option.none.selected { background: rgba(100, 116, 139, 0.2); }

        .rag-option-dot {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin: 0 auto 8px;
        }

        .rag-option.red .rag-option-dot { background: #ef4444; }
        .rag-option.amber .rag-option-dot { background: #f59e0b; }
        .rag-option.green .rag-option-dot { background: #22c55e; }
        .rag-option.none .rag-option-dot { background: #64748b; }

        .rag-option-label {
            font-size: 0.75rem;
            color: #94a3b8;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 25px;
        }

        .modal button {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .modal .btn-cancel {
            background: transparent;
            border: 1px solid rgba(255,255,255,0.2);
            color: #94a3b8;
        }

        .modal .btn-save {
            background: #3b82f6;
            border: none;
            color: white;
        }

        .modal .btn-save:hover { background: #2563eb; }

        @media (max-width: 768px) {
            .gantt-header, .gantt-row {
                grid-template-columns: 40px 200px 1fr;
            }
            .modal { min-width: 90%; }
            .summary-section { grid-template-columns: 1fr; }
        }

        /* Summary Section */
        .summary-section {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 30px;
        }

        .summary-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 20px;
        }

        .summary-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }

        .summary-item:last-child { border-bottom: none; }

        .summary-item span:first-child {
            font-size: 0.9rem;
            color: #e2e8f0;
        }

        .summary-date {
            font-size: 0.8rem;
            color: #64748b;
        }

        /* Weather Widget */
        .weather-widget {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(139, 92, 246, 0.15) 100%);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 12px;
            padding: 16px;
            margin-top: 20px;
        }

        .weather-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 12px;
        }

        .weather-header .location { font-size: 0.85rem; color: #94a3b8; }
        .weather-header .weather-icon { font-size: 1.2rem; }

        .weather-current {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .weather-temp { font-size: 2.5rem; font-weight: 700; color: #60a5fa; }
        .weather-condition { font-size: 0.9rem; color: #e4e4e7; }

        .weather-forecast {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .forecast-day {
            flex: 1;
            min-width: 70px;
            text-align: center;
            padding: 10px 8px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
        }

        .forecast-day .day-name { font-size: 0.7rem; color: #94a3b8; margin-bottom: 6px; }
        .forecast-day .day-icon { font-size: 1.2rem; margin-bottom: 4px; }
        .forecast-day .day-temp { font-size: 0.85rem; font-weight: 600; color: #e4e4e7; }
        .forecast-day .day-precip { font-size: 0.65rem; color: #60a5fa; margin-top: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Fluidstack 245MW Data Center - Construction Schedule</h1>
            <p class="subtitle">Sullivan, Indiana | January 2026 - February 2028 | Schedule Date: 02/06/25</p>

            <div class="project-info">
                <div class="info-card">
                    <label>Project Status</label>
                    <div class="value">Pre-Construction</div>
                </div>
                <div class="info-card">
                    <label>Capacity</label>
                    <div class="value">245 MW</div>
                </div>
                <div class="info-card">
                    <label>Data Halls</label>
                    <div class="value">4 Halls</div>
                </div>
                <div class="info-card">
                    <label>Total Duration</label>
                    <div class="value">521 Days</div>
                </div>
                <div class="info-card">
                    <label>Project Start</label>
                    <div class="value">Jan 21, 2026</div>
                </div>
                <div class="info-card">
                    <label>Project End</label>
                    <div class="value">Feb 7, 2028</div>
                </div>
            </div>

            <!-- Weather Widget for Sullivan, IN -->
            <div class="weather-widget">
                <div class="weather-header">
                    <span class="weather-icon">üìç</span>
                    <span class="location">Sullivan, Indiana - Site Weather</span>
                </div>
                <div class="weather-current">
                    <div>
                        <div class="weather-temp" id="weather-temp">--¬∞F</div>
                        <div class="weather-condition" id="weather-cond">Loading...</div>
                    </div>
                </div>
                <div class="weather-forecast">
                    <div class="forecast-day"><div class="day-name">WED</div><div class="day-icon">‚õÖ</div><div class="day-temp">38¬∞F</div><div class="day-precip">10% üíß</div></div>
                    <div class="forecast-day"><div class="day-name">THU</div><div class="day-icon">‚òÅÔ∏è</div><div class="day-temp">42¬∞F</div><div class="day-precip">25% üíß</div></div>
                    <div class="forecast-day"><div class="day-name">FRI</div><div class="day-icon">üåßÔ∏è</div><div class="day-temp">36¬∞F</div><div class="day-precip">60% üíß</div></div>
                    <div class="forecast-day"><div class="day-name">SAT</div><div class="day-icon">üå®Ô∏è</div><div class="day-temp">30¬∞F</div><div class="day-precip">40% ‚ùÑÔ∏è</div></div>
                    <div class="forecast-day"><div class="day-name">SUN</div><div class="day-icon">‚òÄÔ∏è</div><div class="day-temp">35¬∞F</div><div class="day-precip">5%</div></div>
                </div>
            </div>
        </header>

        <div class="controls">
            <button class="filter-btn active" data-filter="all">All Phases</button>
            <button class="filter-btn" data-filter="design">Design</button>
            <button class="filter-btn" data-filter="procurement">Procurement</button>
            <button class="filter-btn" data-filter="construction">Construction</button>
            <button class="filter-btn" data-filter="datahall">Data Halls</button>
            <button class="filter-btn" data-filter="commissioning">Commissioning</button>
        </div>

        <!-- RAG Legend -->
        <div class="rag-legend">
            <span class="rag-legend-title">RAG Status:</span>
            <div class="rag-item"><div class="rag-dot red"></div> Red - At Risk</div>
            <div class="rag-item"><div class="rag-dot amber"></div> Amber - Caution</div>
            <div class="rag-item"><div class="rag-dot green"></div> Green - On Track</div>
            <div class="rag-item"><div class="rag-dot none"></div> Not Set</div>
            <span style="margin-left: auto; font-size: 0.75rem; color: #64748b;">Click task name to add comments</span>
        </div>

        <div class="legend">
            <div class="legend-item"><div class="legend-color" style="background: linear-gradient(90deg, #8b5cf6, #a78bfa);"></div>Design</div>
            <div class="legend-item"><div class="legend-color" style="background: linear-gradient(90deg, #6366f1, #818cf8);"></div>Procurement</div>
            <div class="legend-item"><div class="legend-color" style="background: linear-gradient(90deg, #14b8a6, #2dd4bf);"></div>Site Work</div>
            <div class="legend-item"><div class="legend-color" style="background: linear-gradient(90deg, #3b82f6, #60a5fa);"></div>Building</div>
            <div class="legend-item"><div class="legend-color" style="background: linear-gradient(90deg, #0ea5e9, #38bdf8);"></div>Mechanical</div>
            <div class="legend-item"><div class="legend-color" style="background: linear-gradient(90deg, #f59e0b, #fbbf24);"></div>Electrical</div>
            <div class="legend-item"><div class="legend-color" style="background: linear-gradient(90deg, #10b981, #34d399);"></div>Data Hall</div>
            <div class="legend-item"><div class="legend-color" style="background: linear-gradient(90deg, #ec4899, #f472b6);"></div>Commissioning</div>
            <div class="legend-item"><div class="legend-color" style="background: linear-gradient(90deg, #22c55e, #4ade80);"></div>Milestone</div>
        </div>

        <div class="gantt-container">
            <div class="gantt-header">
                <div class="rag-header">RAG</div>
                <div class="task-header">Task Name</div>
                <div class="timeline-header" id="timeline-header"></div>
            </div>
            <div class="gantt-body" id="gantt-body"></div>
        </div>

        <!-- Summary Section -->
        <div class="summary-section">
            <div class="summary-card">
                <h3 class="summary-title" style="color: #60a5fa;">Data Hall Milestones</h3>
                <div class="summary-item"><span>DH1 - Early Floor Access</span><span class="summary-date">Apr 15, 2027</span></div>
                <div class="summary-item"><span>DH1 - Floor Access</span><span class="summary-date">May 27, 2027</span></div>
                <div class="summary-item"><span>DH1 - Facility Ready</span><span class="summary-date">Jul 29, 2027</span></div>
                <div class="summary-item"><span>DH2 - Facility Ready</span><span class="summary-date">Oct 1, 2027</span></div>
                <div class="summary-item"><span>DH3 - Facility Ready</span><span class="summary-date">Dec 7, 2027</span></div>
                <div class="summary-item"><span>DH4 - Facility Ready</span><span class="summary-date">Feb 7, 2028</span></div>
            </div>

            <div class="summary-card">
                <h3 class="summary-title" style="color: #22c55e;">Key Procurement Items</h3>
                <div class="summary-item"><span>MV Switchgear</span><span class="summary-date">Feb - Oct 2026</span></div>
                <div class="summary-item"><span>Ring Main Units</span><span class="summary-date">Jan - Aug 2026</span></div>
                <div class="summary-item"><span>Generators</span><span class="summary-date">Feb - Sep 2026</span></div>
                <div class="summary-item"><span>Busway & ATS</span><span class="summary-date">Feb - Oct 2026</span></div>
                <div class="summary-item"><span>Air Cooled Chillers</span><span class="summary-date">Feb - Sep 2026</span></div>
                <div class="summary-item"><span>CRAH Units</span><span class="summary-date">Feb - Oct 2026</span></div>
            </div>

            <div class="summary-card">
                <h3 class="summary-title" style="color: #a78bfa;">Construction Phases</h3>
                <div class="summary-item"><span>Core & Shell</span><span class="summary-date">Apr 2026 - Jan 2027</span></div>
                <div class="summary-item"><span>DH1 Infrastructure</span><span class="summary-date">Sep 2026 - Jan 2027</span></div>
                <div class="summary-item"><span>DH1 Commissioning</span><span class="summary-date">Oct 2026 - Jul 2027</span></div>
                <div class="summary-item"><span>DH2 Commissioning</span><span class="summary-date">Nov 2026 - Oct 2027</span></div>
                <div class="summary-item"><span>DH3 Commissioning</span><span class="summary-date">Jan 2027 - Dec 2027</span></div>
                <div class="summary-item"><span>DH4 Commissioning</span><span class="summary-date">Mar 2027 - Feb 2028</span></div>
            </div>
        </div>
    </div>

    <!-- Tooltip -->
    <div class="tooltip" id="tooltip">
        <div class="tooltip-title"></div>
        <div class="tooltip-content"></div>
    </div>

    <!-- Edit Modal -->
    <div class="modal-overlay" id="modal">
        <div class="modal">
            <h3 id="modal-title">Edit Task</h3>
            <div class="input-group">
                <label>RAG Status</label>
                <div class="rag-select-group">
                    <div class="rag-option red" data-rag="red" onclick="selectRag('red')">
                        <div class="rag-option-dot"></div>
                        <div class="rag-option-label">Red</div>
                    </div>
                    <div class="rag-option amber" data-rag="amber" onclick="selectRag('amber')">
                        <div class="rag-option-dot"></div>
                        <div class="rag-option-label">Amber</div>
                    </div>
                    <div class="rag-option green" data-rag="green" onclick="selectRag('green')">
                        <div class="rag-option-dot"></div>
                        <div class="rag-option-label">Green</div>
                    </div>
                    <div class="rag-option none" data-rag="none" onclick="selectRag('none')">
                        <div class="rag-option-dot"></div>
                        <div class="rag-option-label">None</div>
                    </div>
                </div>
            </div>
            <div class="input-group">
                <label>Comments / Notes</label>
                <textarea id="modal-comment" placeholder="Add notes about why this task is at its current status..."></textarea>
            </div>
            <div class="modal-buttons">
                <button class="btn-cancel" onclick="closeModal()">Cancel</button>
                <button class="btn-save" onclick="saveTask()">Save</button>
            </div>
        </div>
    </div>

    <script>
        const monthWidth = 60;
        const totalMonths = 26; // Jan 2026 through Feb 2028
        let currentTaskId = null;
        let selectedRag = 'none';

        const taskData = {};

        // Month 0 = Jan 2026, Month 25 = Feb 2028
        const tasks = [
            // ===== KEY MILESTONES =====
            { id: 'milestones', name: 'KEY MILESTONES', phase: 'all', isPhase: true },
            { id: 'm1', name: 'Release ARCO on Design', start: 0.3, duration: 0.3, type: 'milestone', phase: 'all', indent: 1, isMilestone: true, date: 'Jan 30, 2026' },
            { id: 'm2', name: 'Release ARCO on Equipment Procurement', start: 1.5, duration: 0.3, type: 'milestone', phase: 'all', indent: 1, isMilestone: true, date: 'Feb 16, 2026' },
            { id: 'm3', name: 'Land Disturbance Permit Issuance', start: 3.5, duration: 0.3, type: 'milestone', phase: 'all', indent: 1, isMilestone: true, date: 'Apr 16, 2026' },
            { id: 'm4', name: 'Mobilization', start: 3.7, duration: 0.3, type: 'milestone', phase: 'all', indent: 1, isMilestone: true, date: 'Apr 21, 2026' },
            { id: 'm5', name: 'Pad Turnover 50%', start: 5.6, duration: 0.3, type: 'milestone', phase: 'all', indent: 1, isMilestone: true, date: 'Jun 18, 2026' },
            { id: 'm6', name: 'Utility Power at Substation', start: 8.1, duration: 0.3, type: 'milestone', phase: 'all', indent: 1, isMilestone: true, date: 'Sep 4, 2026' },
            { id: 'm7', name: 'Substantial Completion - Core & Shell', start: 12.7, duration: 0.3, type: 'milestone', phase: 'all', indent: 1, isMilestone: true, date: 'Jan 21, 2027' },
            { id: 'm_dh1_efa', name: 'DH1 - Early Floor Access (EFA)', start: 15.5, duration: 0.3, type: 'milestone', phase: 'all', indent: 1, isMilestone: true, date: 'Apr 15, 2027' },
            { id: 'm_dh1_fa', name: 'DH1 - Floor Access (FA)', start: 16.9, duration: 0.3, type: 'milestone', phase: 'all', indent: 1, isMilestone: true, date: 'May 27, 2027' },
            { id: 'm_dh1_fr', name: 'DH1 - Facility Ready (FR)', start: 18.9, duration: 0.3, type: 'milestone', phase: 'all', indent: 1, isMilestone: true, date: 'Jul 29, 2027' },
            { id: 'm_dh2_fr', name: 'DH2 - Facility Ready (FR)', start: 21, duration: 0.3, type: 'milestone', phase: 'all', indent: 1, isMilestone: true, date: 'Oct 1, 2027' },
            { id: 'm_dh3_fr', name: 'DH3 - Facility Ready (FR)', start: 23.2, duration: 0.3, type: 'milestone', phase: 'all', indent: 1, isMilestone: true, date: 'Dec 7, 2027' },
            { id: 'm_dh4_fr', name: 'DH4 - Facility Ready (FR)', start: 25.2, duration: 0.3, type: 'milestone', phase: 'all', indent: 1, isMilestone: true, date: 'Feb 7, 2028' },

            // ===== PRECONSTRUCTION, DESIGN & PROCUREMENT =====
            { id: 'precon', name: 'PRECONSTRUCTION, DESIGN & PROCUREMENT', phase: 'design', isPhase: true },

            // Civil Design
            { id: 'civil', name: 'Civil Design', start: 0, duration: 3, type: 'design', phase: 'design', indent: 1 },
            { id: 'civil1', name: 'Civil Design Documents', start: 0, duration: 1, type: 'design', phase: 'design', indent: 2 },
            { id: 'civil2', name: 'Local AHJ Civil Review', start: 1.6, duration: 2, type: 'design', phase: 'design', indent: 2 },
            { id: 'civil3', name: 'Issue Land Disturbance Permit', start: 3.5, duration: 0.3, type: 'milestone', phase: 'design', indent: 2, isMilestone: true, date: 'Apr 16, 2026' },

            // Building & Data Hall Design
            { id: 'bldgdesign', name: 'Building & Data Hall Design', start: 1, duration: 3.6, type: 'design', phase: 'design', indent: 1 },
            { id: 'bd1', name: 'Schematic Design & Pricing', start: 1, duration: 0.5, type: 'design', phase: 'design', indent: 2 },
            { id: 'bd2', name: 'Fluidstack - SD Approval', start: 1.5, duration: 0.25, type: 'design', phase: 'design', indent: 2 },
            { id: 'bd3', name: 'Design Documents & Pricing', start: 1.8, duration: 1, type: 'design', phase: 'design', indent: 2 },
            { id: 'bd4', name: 'Fluidstack - DD Approval', start: 2.8, duration: 0.25, type: 'design', phase: 'design', indent: 2 },
            { id: 'bd5', name: 'Permit Documents & Pricing', start: 3, duration: 0.75, type: 'design', phase: 'design', indent: 2 },
            { id: 'bd6', name: 'Submit for Permit', start: 3.7, duration: 0.3, type: 'milestone', phase: 'design', indent: 2, isMilestone: true, date: 'Apr 21, 2026' },
            { id: 'bd7', name: 'IFC Documents & Final Pricing', start: 3.7, duration: 0.5, type: 'design', phase: 'design', indent: 2 },
            { id: 'bd8', name: 'Building Permit Approval', start: 3.7, duration: 1, type: 'design', phase: 'design', indent: 2 },

            // ===== EQUIPMENT PROCUREMENT =====
            { id: 'proc', name: 'EQUIPMENT PROCUREMENT', phase: 'procurement', isPhase: true },
            { id: 'proc_mv', name: 'MV Switchgear', start: 1.5, duration: 8, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_rmu', name: 'Ring Main Units', start: 0.3, duration: 6.5, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_xfmr', name: 'MV Transformers', start: 1.5, duration: 6.5, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_gen', name: 'Generators', start: 1.5, duration: 7.5, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_mcp', name: 'Main Control Panels', start: 1.5, duration: 5, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_swgr', name: 'Switchgear', start: 1.5, duration: 7, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_ups', name: 'UPS', start: 1.5, duration: 6.5, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_bus', name: 'Busway & ATS', start: 1.5, duration: 8, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_chill', name: 'Air Cooled Chillers', start: 1.5, duration: 7, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_doas', name: 'DOAS Units', start: 1.5, duration: 5.5, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_rtu', name: 'RTU', start: 1.5, duration: 5.5, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_fan', name: 'Fanwalls', start: 1.5, duration: 4.5, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_crac', name: 'CRAC Units', start: 1.5, duration: 6.5, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_crah', name: 'CRAH Units', start: 1.5, duration: 8, type: 'procurement', phase: 'procurement', indent: 1 },
            { id: 'proc_hac', name: 'TATE Hot Aisle Containment', start: 9, duration: 2, type: 'procurement', phase: 'procurement', indent: 1 },

            // ===== CONSTRUCTION - CORE & SHELL =====
            { id: 'cs', name: 'CORE & SHELL', phase: 'construction', isPhase: true },

            // Mass Grading
            { id: 'cs_grade', name: 'Mass Grading & Clearing', start: 3.5, duration: 2.5, type: 'sitework', phase: 'construction', indent: 1 },
            { id: 'cs_g1', name: 'Site Work Mobilization', start: 3.5, duration: 0.15, type: 'sitework', phase: 'construction', indent: 2 },
            { id: 'cs_g2', name: 'Erosion Control', start: 3.5, duration: 0.25, type: 'sitework', phase: 'construction', indent: 2 },
            { id: 'cs_g3', name: 'Strip Site / Clear Wooded Areas', start: 3.8, duration: 0.5, type: 'sitework', phase: 'construction', indent: 2 },
            { id: 'cs_g4', name: 'Mass Grading', start: 4, duration: 1.5, type: 'sitework', phase: 'construction', indent: 2 },
            { id: 'cs_g5', name: 'Fine Grading & Stone Pad', start: 5, duration: 1, type: 'sitework', phase: 'construction', indent: 2 },

            // Dry Utilities
            { id: 'cs_dry', name: 'Dry Utilities', start: 4.4, duration: 5.6, type: 'electrical', phase: 'construction', indent: 1 },
            { id: 'cs_d1', name: 'MV Loop Ductbanks', start: 4.4, duration: 1.5, type: 'electrical', phase: 'construction', indent: 2 },
            { id: 'cs_d2', name: 'Chiller Ductbanks', start: 4.4, duration: 3, type: 'electrical', phase: 'construction', indent: 2 },
            { id: 'cs_d3', name: 'Substation Construction', start: 4.4, duration: 4, type: 'electrical', phase: 'construction', indent: 2 },
            { id: 'cs_d4', name: 'Primary Utility Cable Pull & Term', start: 6, duration: 1.2, type: 'electrical', phase: 'construction', indent: 2 },
            { id: 'cs_d5', name: 'MV Loop Cable Pull & Term', start: 8, duration: 1.2, type: 'electrical', phase: 'construction', indent: 2 },

            // Equipment Pads
            { id: 'cs_pads', name: 'Equipment Pads', start: 4.9, duration: 4.6, type: 'building', phase: 'construction', indent: 1 },
            { id: 'cs_p1', name: 'MV Transformer Pads', start: 4.9, duration: 1.5, type: 'building', phase: 'construction', indent: 2 },
            { id: 'cs_p2', name: 'Chiller Pads', start: 5.4, duration: 1.5, type: 'building', phase: 'construction', indent: 2 },

            // Building Foundations
            { id: 'cs_found', name: 'Building Foundations', start: 5.6, duration: 2, type: 'building', phase: 'construction', indent: 1 },
            { id: 'cs_f1', name: 'Perimeter Frost Wall', start: 5.9, duration: 1.3, type: 'building', phase: 'construction', indent: 2 },
            { id: 'cs_f2', name: 'MMR GEN Pads', start: 6, duration: 0.7, type: 'building', phase: 'construction', indent: 2 },

            // Slab on Grade
            { id: 'cs_sog', name: 'Slab on Grade', start: 7, duration: 2.2, type: 'building', phase: 'construction', indent: 1 },
            { id: 'cs_s1', name: 'DH1 SOG', start: 7, duration: 0.5, type: 'building', phase: 'construction', indent: 2 },
            { id: 'cs_s2', name: 'DH2 SOG', start: 7.6, duration: 0.5, type: 'building', phase: 'construction', indent: 2 },
            { id: 'cs_s3', name: 'DH3 SOG', start: 8.3, duration: 0.5, type: 'building', phase: 'construction', indent: 2 },
            { id: 'cs_s4', name: 'DH4 SOG', start: 8.8, duration: 0.5, type: 'building', phase: 'construction', indent: 2 },

            // Wet Utilities
            { id: 'cs_wet', name: 'Wet Utilities', start: 5, duration: 4.5, type: 'mechanical', phase: 'construction', indent: 1 },
            { id: 'cs_w1', name: 'Storm Sewer', start: 5, duration: 0.75, type: 'mechanical', phase: 'construction', indent: 2 },
            { id: 'cs_w2', name: 'Fire & Domestic Water Loops', start: 6.3, duration: 0.5, type: 'mechanical', phase: 'construction', indent: 2 },
            { id: 'cs_w3', name: 'Interior Fire Protection', start: 7.4, duration: 1.7, type: 'mechanical', phase: 'construction', indent: 2 },
            { id: 'cs_w4', name: 'Fire Pump and Testing', start: 9, duration: 0.5, type: 'mechanical', phase: 'construction', indent: 2 },

            // Structure & Skin
            { id: 'cs_struct', name: 'Structure & Skin (PEMB)', start: 5.9, duration: 5.6, type: 'building', phase: 'construction', indent: 1 },
            { id: 'cs_st1', name: 'DH1 (Structure/Walls/Roof)', start: 5.9, duration: 1.8, type: 'building', phase: 'construction', indent: 2 },
            { id: 'cs_st2', name: 'DH2 (Structure/Walls/Roof)', start: 7, duration: 1.8, type: 'building', phase: 'construction', indent: 2 },
            { id: 'cs_st3', name: 'DH3 (Structure/Walls/Roof)', start: 8.3, duration: 1.8, type: 'building', phase: 'construction', indent: 2 },
            { id: 'cs_st4', name: 'DH4 (Structure/Walls/Roof)', start: 9.4, duration: 1.8, type: 'building', phase: 'construction', indent: 2 },
            { id: 'cs_st5', name: 'Office/Storage Area', start: 6.7, duration: 1.2, type: 'building', phase: 'construction', indent: 2 },

            // Exterior & Office
            { id: 'cs_ext', name: 'Exterior Improvements', start: 6.8, duration: 1.4, type: 'sitework', phase: 'construction', indent: 1 },
            { id: 'cs_off', name: 'Office Buildout', start: 7.9, duration: 3.3, type: 'building', phase: 'construction', indent: 1 },
            { id: 'cs_close', name: 'Building Closeout & Punchlist', start: 11.2, duration: 1.5, type: 'closeout', phase: 'construction', indent: 1 },
            { id: 'cs_weather', name: 'Weather Delay Allowance', start: 11.7, duration: 1, type: 'closeout', phase: 'construction', indent: 1 },

            // ===== DATA HALL 1 - 65 MW =====
            { id: 'dh1', name: 'DATA HALL 1 - 65 MW', phase: 'datahall', isPhase: true },
            { id: 'dh1_del', name: 'DH1 Equipment Deliveries', start: 8, duration: 4.3, type: 'datahall', phase: 'datahall', indent: 1 },
            { id: 'dh1_d1', name: 'Chillers Delivery', start: 8.3, duration: 0.3, type: 'milestone', phase: 'datahall', indent: 2, isMilestone: true, date: 'Sep 10, 2026' },
            { id: 'dh1_d2', name: 'Switchgear / MCP / Generators', start: 8.8, duration: 0.3, type: 'milestone', phase: 'datahall', indent: 2, isMilestone: true, date: 'Sep 23-24, 2026' },
            { id: 'dh1_d3', name: 'MV Switches', start: 9.5, duration: 0.3, type: 'milestone', phase: 'datahall', indent: 2, isMilestone: true, date: 'Oct 15, 2026' },
            { id: 'dh1_d4', name: 'UPS / PDUs', start: 10.1, duration: 0.3, type: 'milestone', phase: 'datahall', indent: 2, isMilestone: true, date: 'Nov 4-18, 2026' },
            { id: 'dh1_d5', name: 'HAC/Busway/Rack Mount ATS', start: 12.2, duration: 0.3, type: 'milestone', phase: 'datahall', indent: 2, isMilestone: true, date: 'Jan 7, 2027' },

            { id: 'dh1_infra', name: 'DH1 Infrastructure & Equipment Install', start: 8.4, duration: 4.6, type: 'datahall', phase: 'datahall', indent: 1 },
            { id: 'dh1_i1', name: 'Set Chillers', start: 8.4, duration: 1, type: 'mechanical', phase: 'datahall', indent: 2 },
            { id: 'dh1_i2', name: 'Mechanical Primary Loop Rough-in', start: 8.8, duration: 2.2, type: 'mechanical', phase: 'datahall', indent: 2 },
            { id: 'dh1_i3', name: 'Switchgear Installation', start: 8.8, duration: 1.5, type: 'electrical', phase: 'datahall', indent: 2 },
            { id: 'dh1_i4', name: 'Power/BMS/EPMS Pathway Rough-In', start: 8.8, duration: 1.5, type: 'electrical', phase: 'datahall', indent: 2 },
            { id: 'dh1_i5', name: 'Electrical Termination & Testing', start: 10.2, duration: 1.5, type: 'electrical', phase: 'datahall', indent: 2 },
            { id: 'dh1_i6', name: 'UPS Installation', start: 10.2, duration: 0.5, type: 'electrical', phase: 'datahall', indent: 2 },
            { id: 'dh1_i7', name: 'PDU Installation', start: 10.6, duration: 0.5, type: 'electrical', phase: 'datahall', indent: 2 },
            { id: 'dh1_i8', name: 'Structural Racking Installation', start: 11.2, duration: 1, type: 'datahall', phase: 'datahall', indent: 2 },
            { id: 'dh1_i9', name: 'Racking Electrical Fitout (Busway & STS)', start: 12.3, duration: 0.5, type: 'electrical', phase: 'datahall', indent: 2 },

            { id: 'dh1_cx', name: 'DH1 Commissioning & Turnover', start: 9.3, duration: 9.6, type: 'commissioning', phase: 'commissioning', indent: 1 },
            { id: 'dh1_cx1', name: 'L3 Pre-Functional Testing & FTEs', start: 9.3, duration: 6.2, type: 'commissioning', phase: 'commissioning', indent: 2 },
            { id: 'dh1_cx2', name: 'NETA Testing', start: 10.2, duration: 1.2, type: 'commissioning', phase: 'commissioning', indent: 2 },
            { id: 'dh1_cx3', name: 'L4 Functional Testing', start: 11.7, duration: 5.3, type: 'commissioning', phase: 'commissioning', indent: 2 },
            { id: 'dh1_cx4', name: 'Generator Loadbanking', start: 11.7, duration: 0.5, type: 'commissioning', phase: 'commissioning', indent: 2 },
            { id: 'dh1_cx5', name: 'L5 Integrated System Testing', start: 16.9, duration: 2, type: 'commissioning', phase: 'commissioning', indent: 2 },
            { id: 'dh1_cx6', name: '24-48 Hour Full System Burn', start: 16.9, duration: 0.25, type: 'commissioning', phase: 'commissioning', indent: 3 },
            { id: 'dh1_cx7', name: 'Failover Simulation', start: 17.2, duration: 0.25, type: 'commissioning', phase: 'commissioning', indent: 3 },
            { id: 'dh1_cx8', name: 'Owner FR Activities', start: 17.4, duration: 1.6, type: 'commissioning', phase: 'commissioning', indent: 3 },

            // ===== DATA HALL 2 - 60 MW =====
            { id: 'dh2', name: 'DATA HALL 2 - 60 MW', phase: 'datahall', isPhase: true },
            { id: 'dh2_del', name: 'DH2 Equipment Deliveries', start: 8.8, duration: 4.2, type: 'datahall', phase: 'datahall', indent: 1 },
            { id: 'dh2_infra', name: 'DH2 Infrastructure & Equipment Install', start: 9.3, duration: 4, type: 'datahall', phase: 'datahall', indent: 1 },
            { id: 'dh2_i1', name: 'Set Chillers', start: 9.3, duration: 1, type: 'mechanical', phase: 'datahall', indent: 2 },
            { id: 'dh2_i2', name: 'Switchgear Installation', start: 9.5, duration: 1.5, type: 'electrical', phase: 'datahall', indent: 2 },
            { id: 'dh2_i3', name: 'Mechanical Primary Loop Rough-in', start: 10.2, duration: 1.5, type: 'mechanical', phase: 'datahall', indent: 2 },
            { id: 'dh2_i4', name: 'Electrical Termination & Testing', start: 10.6, duration: 1.5, type: 'electrical', phase: 'datahall', indent: 2 },
            { id: 'dh2_i5', name: 'Structural Racking Installation', start: 12, duration: 0.7, type: 'datahall', phase: 'datahall', indent: 2 },
            { id: 'dh2_i6', name: 'Racking Electrical Fitout (Busway & STS)', start: 12.7, duration: 0.5, type: 'electrical', phase: 'datahall', indent: 2 },

            { id: 'dh2_cx', name: 'DH2 Commissioning & Turnover', start: 10.9, duration: 10.1, type: 'commissioning', phase: 'commissioning', indent: 1 },
            { id: 'dh2_cx1', name: 'L3 Pre-Functional Testing & FTEs', start: 10.9, duration: 6.8, type: 'commissioning', phase: 'commissioning', indent: 2 },
            { id: 'dh2_cx2', name: 'L4 Functional Testing', start: 16.2, duration: 2.8, type: 'commissioning', phase: 'commissioning', indent: 2 },
            { id: 'dh2_cx3', name: 'L5 Integrated System Testing', start: 19, duration: 2, type: 'commissioning', phase: 'commissioning', indent: 2 },

            // ===== DATA HALL 3 - 60 MW =====
            { id: 'dh3', name: 'DATA HALL 3 - 60 MW', phase: 'datahall', isPhase: true },
            { id: 'dh3_del', name: 'DH3 Equipment Deliveries', start: 9.3, duration: 5.3, type: 'datahall', phase: 'datahall', indent: 1 },
            { id: 'dh3_infra', name: 'DH3 Infrastructure & Equipment Install', start: 9.3, duration: 5.8, type: 'datahall', phase: 'datahall', indent: 1 },
            { id: 'dh3_i1', name: 'Set Chillers', start: 9.3, duration: 1, type: 'mechanical', phase: 'datahall', indent: 2 },
            { id: 'dh3_i2', name: 'Switchgear Installation', start: 11.3, duration: 1.5, type: 'electrical', phase: 'datahall', indent: 2 },
            { id: 'dh3_i3', name: 'Mechanical Primary Loop Rough-in', start: 12, duration: 1.5, type: 'mechanical', phase: 'datahall', indent: 2 },
            { id: 'dh3_i4', name: 'Electrical Termination & Testing', start: 13, duration: 1.5, type: 'electrical', phase: 'datahall', indent: 2 },
            { id: 'dh3_i5', name: 'Structural Racking Installation', start: 13.7, duration: 0.7, type: 'datahall', phase: 'datahall', indent: 2 },
            { id: 'dh3_i6', name: 'Racking Electrical Fitout (Busway & STS)', start: 14.4, duration: 0.5, type: 'electrical', phase: 'datahall', indent: 2 },

            { id: 'dh3_cx', name: 'DH3 Commissioning & Turnover', start: 12.8, duration: 10.4, type: 'commissioning', phase: 'commissioning', indent: 1 },
            { id: 'dh3_cx1', name: 'L3 Pre-Functional Testing & FTEs', start: 12.8, duration: 7.2, type: 'commissioning', phase: 'commissioning', indent: 2 },
            { id: 'dh3_cx2', name: 'L4 Functional Testing', start: 18.5, duration: 2.8, type: 'commissioning', phase: 'commissioning', indent: 2 },
            { id: 'dh3_cx3', name: 'L5 Integrated System Testing', start: 21.2, duration: 2, type: 'commissioning', phase: 'commissioning', indent: 2 },

            // ===== DATA HALL 4 - 60 MW =====
            { id: 'dh4', name: 'DATA HALL 4 - 60 MW', phase: 'datahall', isPhase: true },
            { id: 'dh4_del', name: 'DH4 Equipment Deliveries', start: 10.5, duration: 5.5, type: 'datahall', phase: 'datahall', indent: 1 },
            { id: 'dh4_infra', name: 'DH4 Infrastructure & Equipment Install', start: 11, duration: 5.5, type: 'datahall', phase: 'datahall', indent: 1 },
            { id: 'dh4_i1', name: 'Set Chillers', start: 11, duration: 1, type: 'mechanical', phase: 'datahall', indent: 2 },
            { id: 'dh4_i2', name: 'Switchgear Installation', start: 13, duration: 1.5, type: 'electrical', phase: 'datahall', indent: 2 },
            { id: 'dh4_i3', name: 'Mechanical Primary Loop Rough-in', start: 13.5, duration: 1.5, type: 'mechanical', phase: 'datahall', indent: 2 },
            { id: 'dh4_i4', name: 'Electrical Termination & Testing', start: 14.5, duration: 1.5, type: 'electrical', phase: 'datahall', indent: 2 },
            { id: 'dh4_i5', name: 'Structural Racking Installation', start: 15.2, duration: 0.7, type: 'datahall', phase: 'datahall', indent: 2 },
            { id: 'dh4_i6', name: 'Racking Electrical Fitout (Busway & STS)', start: 15.9, duration: 0.5, type: 'electrical', phase: 'datahall', indent: 2 },

            { id: 'dh4_cx', name: 'DH4 Commissioning & Turnover', start: 14.5, duration: 10.7, type: 'commissioning', phase: 'commissioning', indent: 1 },
            { id: 'dh4_cx1', name: 'L3 Pre-Functional Testing & FTEs', start: 14.5, duration: 7.2, type: 'commissioning', phase: 'commissioning', indent: 2 },
            { id: 'dh4_cx2', name: 'L4 Functional Testing', start: 20.2, duration: 2.8, type: 'commissioning', phase: 'commissioning', indent: 2 },
            { id: 'dh4_cx3', name: 'L5 Integrated System Testing', start: 23, duration: 2.2, type: 'commissioning', phase: 'commissioning', indent: 2 },
        ];

        // Generate month labels starting from Jan 2026
        function generateMonthLabels() {
            const header = document.getElementById('timeline-header');
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            let monthIndex = 0; // Start at January
            let year = 2026;

            for (let i = 0; i < totalMonths; i++) {
                const label = document.createElement('div');
                const isYearStart = monthIndex === 0 && i > 0;
                label.className = 'month-label' + (isYearStart ? ' year-start' : '');
                label.textContent = months[monthIndex] + (monthIndex === 0 || i === 0 ? " '" + year.toString().slice(-2) : '');
                header.appendChild(label);

                monthIndex++;
                if (monthIndex > 11) {
                    monthIndex = 0;
                    year++;
                }
            }
        }

        function generateGridLines() {
            let html = '';
            let monthIndex = 0;
            for (let i = 0; i < totalMonths; i++) {
                const isYearStart = monthIndex === 0 && i > 0;
                html += '<div class="grid-line' + (isYearStart ? ' year-start' : '') + '"></div>';
                monthIndex++;
                if (monthIndex > 11) monthIndex = 0;
            }
            return html;
        }

        function getTaskData(taskId) {
            return taskData[taskId] || { rag: 'none', comment: '' };
        }

        function renderGantt(filter) {
            filter = filter || 'all';
            const body = document.getElementById('gantt-body');
            let html = '';

            tasks.forEach(function(task) {
                if (filter !== 'all') {
                    if (filter === 'design' && task.phase !== 'design') return;
                    if (filter === 'procurement' && task.phase !== 'procurement') return;
                    if (filter === 'construction' && task.phase !== 'construction') return;
                    if (filter === 'datahall' && task.phase !== 'datahall') return;
                    if (filter === 'commissioning' && task.phase !== 'commissioning') return;
                }

                const indentClass = task.indent ? 'task-indent-' + task.indent : '';
                const phaseClass = task.isPhase ? 'phase-header' : '';
                const data = getTaskData(task.id);

                html += '<div class="gantt-row ' + phaseClass + '" data-phase="' + task.phase + '" data-id="' + task.id + '">';

                // RAG Cell
                html += '<div class="rag-cell" onclick="editTask(\'' + task.id + '\', \'' + task.name.replace(/'/g, "\\'") + '\')">';
                if (!task.isPhase) {
                    html += '<div class="rag-indicator ' + data.rag + '"></div>';
                }
                html += '</div>';

                // Task Cell
                html += '<div class="task-cell ' + indentClass + '" onclick="editTask(\'' + task.id + '\', \'' + task.name.replace(/'/g, "\\'") + '\')">';
                html += '<span class="task-name">' + task.name + '</span>';
                if (data.comment) {
                    html += '<span class="has-comment" title="Has comment">üí¨</span>';
                }
                if (task.duration && !task.isPhase && !task.isMilestone && task.duration > 0.5) {
                    html += '<span class="task-duration">' + task.duration.toFixed(1) + 'mo</span>';
                }
                if (task.date) {
                    html += '<span class="task-duration">' + task.date + '</span>';
                }
                html += '</div>';

                // Timeline Cell
                html += '<div class="timeline-cell">';
                html += '<div class="grid-lines">' + generateGridLines() + '</div>';

                if (task.start !== undefined && task.duration) {
                    const left = task.start * monthWidth;
                    const width = Math.max(task.duration * monthWidth - 4, 20);

                    if (task.isMilestone) {
                        html += '<div class="milestone-marker" style="left: ' + (left + 10) + 'px" data-label="' + task.name + '"></div>';
                    } else {
                        html += '<div class="bar ' + task.type + '" style="left: ' + left + 'px; width: ' + width + 'px" ';
                        html += 'data-task="' + task.name + '" data-start="' + task.start + '" data-duration="' + task.duration + '" data-type="' + task.type + '">';
                        html += (width > 100 ? task.name : '');
                        html += '</div>';
                    }
                }

                html += '</div></div>';
            });

            body.innerHTML = html;
            attachBarListeners();
        }

        function editTask(taskId, taskName) {
            currentTaskId = taskId;
            document.getElementById('modal-title').textContent = taskName;

            const data = getTaskData(taskId);
            selectedRag = data.rag || 'none';
            document.getElementById('modal-comment').value = data.comment || '';

            document.querySelectorAll('.rag-option').forEach(function(el) {
                el.classList.remove('selected');
                if (el.dataset.rag === selectedRag) {
                    el.classList.add('selected');
                }
            });

            document.getElementById('modal').classList.add('active');
        }

        function selectRag(rag) {
            selectedRag = rag;
            document.querySelectorAll('.rag-option').forEach(function(el) {
                el.classList.remove('selected');
                if (el.dataset.rag === rag) {
                    el.classList.add('selected');
                }
            });
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('active');
            currentTaskId = null;
        }

        function saveTask() {
            const comment = document.getElementById('modal-comment').value.trim();

            taskData[currentTaskId] = {
                rag: selectedRag,
                comment: comment
            };

            saveToStorage();
            renderGantt(document.querySelector('.filter-btn.active').dataset.filter);
            closeModal();
        }

        function saveToStorage() {
            // Data persists in-memory for this session
        }

        function loadFromStorage() {
            // Data persists in-memory for this session
        }

        function attachBarListeners() {
            const tooltip = document.getElementById('tooltip');
            const bars = document.querySelectorAll('.bar');

            bars.forEach(function(bar) {
                bar.addEventListener('mouseenter', function(e) {
                    const task = bar.dataset.task;
                    const startMonth = parseFloat(bar.dataset.start);
                    const duration = parseFloat(bar.dataset.duration);
                    const type = bar.dataset.type;

                    // Calculate actual dates from Jan 2026
                    const startDate = new Date(2026, Math.floor(startMonth), 1);
                    const endDate = new Date(2026, Math.floor(startMonth + duration), 0);

                    const formatDate = function(d) {
                        return d.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
                    };

                    const categoryName = type.charAt(0).toUpperCase() + type.slice(1);
                    const durationWeeks = Math.round(duration * 4.33);

                    tooltip.querySelector('.tooltip-title').textContent = task;
                    tooltip.querySelector('.tooltip-content').innerHTML =
                        '<div class="tooltip-row"><span class="tooltip-label">Start:</span><span>' + formatDate(startDate) + '</span></div>' +
                        '<div class="tooltip-row"><span class="tooltip-label">End:</span><span>' + formatDate(endDate) + '</span></div>' +
                        '<div class="tooltip-row"><span class="tooltip-label">Duration:</span><span>~' + durationWeeks + ' weeks</span></div>' +
                        '<div class="tooltip-row"><span class="tooltip-label">Category:</span><span>' + categoryName + '</span></div>';

                    tooltip.classList.add('visible');
                });

                bar.addEventListener('mousemove', function(e) {
                    tooltip.style.left = e.clientX + 15 + 'px';
                    tooltip.style.top = e.clientY + 15 + 'px';
                });

                bar.addEventListener('mouseleave', function() {
                    tooltip.classList.remove('visible');
                });
            });
        }

        // Filter buttons
        document.querySelectorAll('.filter-btn').forEach(function(btn) {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.filter-btn').forEach(function(b) {
                    b.classList.remove('active');
                });
                btn.classList.add('active');
                renderGantt(btn.dataset.filter);
            });
        });

        // Close modal on overlay click
        document.getElementById('modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Initialize
        loadFromStorage();
        generateMonthLabels();
        renderGantt();
    </script>
</body>
</html>
